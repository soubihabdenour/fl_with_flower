[2024-09-14 23:29:27,774][flwr][INFO] - Starting Flower simulation, config: num_rounds=100, no round_timeout
[2024-09-14 23:29:30,927][flwr][INFO] - Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'CPU': 256.0, 'node:115.145.172.224': 1.0, 'object_store_memory': 76547164569.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'memory': 168610050663.0}
[2024-09-14 23:29:30,927][flwr][INFO] - Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
[2024-09-14 23:29:30,927][flwr][INFO] - Flower VCE: Resources for each Virtual Client: {'num_cpus': 64, 'num_gpus': 0.1}
[2024-09-14 23:29:30,939][flwr][INFO] - Flower VCE: Creating VirtualClientEngineActorPool with 4 actors
[2024-09-14 23:29:30,940][flwr][INFO] - [INIT]
[2024-09-14 23:29:30,940][flwr][INFO] - Requesting initial parameters from one random client
[2024-09-14 23:29:35,214][flwr][INFO] - Received initial parameters from one random client
[2024-09-14 23:29:35,214][flwr][INFO] - Evaluating initial global parameters
[2024-09-14 23:29:41,688][flwr][INFO] - initial parameters (loss, other metrics): 225.44166350364685, {'accuracy': 0.07833966676410406}
[2024-09-14 23:29:41,689][flwr][INFO] - 
[2024-09-14 23:29:41,689][flwr][INFO] - [ROUND 1]
[2024-09-14 23:29:41,689][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:29:48,985][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:29:49,191][flwr][WARNING] - No fit_metrics_aggregation_fn provided
[2024-09-14 23:29:54,568][flwr][INFO] - fit progress: (1, 219.02777779102325, {'accuracy': 0.19467991815258695}, 12.879141909070313)
[2024-09-14 23:29:54,568][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:29:54,928][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:29:54,928][flwr][INFO] - 
[2024-09-14 23:29:54,928][flwr][INFO] - [ROUND 2]
[2024-09-14 23:29:54,928][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:29:59,929][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:30:05,547][flwr][INFO] - fit progress: (2, 219.8976434469223, {'accuracy': 0.19263373282665888}, 23.858500766102225)
[2024-09-14 23:30:05,548][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:30:06,006][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:30:06,007][flwr][INFO] - 
[2024-09-14 23:30:06,007][flwr][INFO] - [ROUND 3]
[2024-09-14 23:30:06,007][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:30:09,644][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:30:15,010][flwr][INFO] - fit progress: (3, 235.09742176532745, {'accuracy': 0.19467991815258695}, 33.321320375893265)
[2024-09-14 23:30:15,011][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:30:15,373][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:30:15,376][flwr][INFO] - 
[2024-09-14 23:30:15,376][flwr][INFO] - [ROUND 4]
[2024-09-14 23:30:15,376][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:30:19,488][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:30:24,550][flwr][INFO] - fit progress: (4, 223.31690537929535, {'accuracy': 0.19467991815258695}, 42.86072731483728)
[2024-09-14 23:30:24,551][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:30:24,957][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:30:24,957][flwr][INFO] - 
[2024-09-14 23:30:24,957][flwr][INFO] - [ROUND 5]
[2024-09-14 23:30:24,958][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:30:25,090][flwr][ERROR] - Traceback (most recent call last):
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=4120949, ip=115.145.172.224, actor_id=212b6d6101ac948817d08cb101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f318c099810>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120949, ip=115.145.172.224, actor_id=212b6d6101ac948817d08cb101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f318c099810>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

[2024-09-14 23:30:25,090][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=4120949, ip=115.145.172.224, actor_id=212b6d6101ac948817d08cb101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f318c099810>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120949, ip=115.145.172.224, actor_id=212b6d6101ac948817d08cb101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f318c099810>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
[2024-09-14 23:30:28,312][flwr][INFO] - aggregate_fit: received 4 results and 1 failures
[2024-09-14 23:30:33,273][flwr][INFO] - fit progress: (5, 213.32632887363434, {'accuracy': 0.182987430575855}, 51.583970989100635)
[2024-09-14 23:30:33,273][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:30:33,631][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:30:33,632][flwr][INFO] - 
[2024-09-14 23:30:33,632][flwr][INFO] - [ROUND 6]
[2024-09-14 23:30:33,632][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:30:36,433][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:30:41,485][flwr][INFO] - fit progress: (6, 225.6375058889389, {'accuracy': 0.1824028061970184}, 59.79650263488293)
[2024-09-14 23:30:41,486][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:30:41,958][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:30:41,958][flwr][INFO] - 
[2024-09-14 23:30:41,958][flwr][INFO] - [ROUND 7]
[2024-09-14 23:30:41,958][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:30:47,267][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:30:52,123][flwr][INFO] - fit progress: (7, 210.92964375019073, {'accuracy': 0.3075124232680503}, 70.43472458980978)
[2024-09-14 23:30:52,124][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:30:52,466][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:30:52,467][flwr][INFO] - 
[2024-09-14 23:30:52,467][flwr][INFO] - [ROUND 8]
[2024-09-14 23:30:52,467][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:30:54,697][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:30:59,636][flwr][INFO] - fit progress: (8, 216.10927546024323, {'accuracy': 0.28120432622040337}, 77.94680285314098)
[2024-09-14 23:30:59,636][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:31:00,041][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:31:00,042][flwr][INFO] - 
[2024-09-14 23:31:00,042][flwr][INFO] - [ROUND 9]
[2024-09-14 23:31:00,042][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:31:03,972][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:31:08,964][flwr][INFO] - fit progress: (9, 214.85655045509338, {'accuracy': 0.17538731365097926}, 87.27557040192187)
[2024-09-14 23:31:08,965][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:31:09,267][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:31:09,267][flwr][INFO] - 
[2024-09-14 23:31:09,267][flwr][INFO] - [ROUND 10]
[2024-09-14 23:31:09,267][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:31:12,484][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:31:17,354][flwr][INFO] - fit progress: (10, 211.3266577720642, {'accuracy': 0.2057877813504823}, 95.66512973885983)
[2024-09-14 23:31:17,354][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:31:17,680][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:31:17,680][flwr][INFO] - 
[2024-09-14 23:31:17,680][flwr][INFO] - [ROUND 11]
[2024-09-14 23:31:17,680][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:31:20,837][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:31:25,789][flwr][INFO] - fit progress: (11, 227.89769887924194, {'accuracy': 0.2753580824320374}, 104.10022305510938)
[2024-09-14 23:31:25,789][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:31:26,139][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:31:26,139][flwr][INFO] - 
[2024-09-14 23:31:26,139][flwr][INFO] - [ROUND 12]
[2024-09-14 23:31:26,139][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:31:26,249][flwr][ERROR] - Traceback (most recent call last):
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

[2024-09-14 23:31:26,249][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
[2024-09-14 23:31:27,504][flwr][INFO] - aggregate_fit: received 4 results and 1 failures
[2024-09-14 23:31:32,338][flwr][INFO] - fit progress: (12, 197.16522240638733, {'accuracy': 0.3756211634025139}, 110.64908624207601)
[2024-09-14 23:31:32,338][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:31:32,705][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:31:32,705][flwr][INFO] - 
[2024-09-14 23:31:32,705][flwr][INFO] - [ROUND 13]
[2024-09-14 23:31:32,705][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:31:35,084][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:31:39,974][flwr][INFO] - fit progress: (13, 193.5209822654724, {'accuracy': 0.3668517977199649}, 118.2854040521197)
[2024-09-14 23:31:39,974][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:31:40,341][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:31:40,341][flwr][INFO] - 
[2024-09-14 23:31:40,341][flwr][INFO] - [ROUND 14]
[2024-09-14 23:31:40,342][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:31:42,820][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:31:47,694][flwr][INFO] - fit progress: (14, 187.63295936584473, {'accuracy': 0.4580532008184741}, 126.00491956574842)
[2024-09-14 23:31:47,694][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:31:48,113][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:31:48,113][flwr][INFO] - 
[2024-09-14 23:31:48,113][flwr][INFO] - [ROUND 15]
[2024-09-14 23:31:48,113][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:31:52,583][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:31:57,518][flwr][INFO] - fit progress: (15, 185.1660659313202, {'accuracy': 0.3215434083601286}, 135.82963276375085)
[2024-09-14 23:31:57,519][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:31:57,940][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:31:57,940][flwr][INFO] - 
[2024-09-14 23:31:57,940][flwr][INFO] - [ROUND 16]
[2024-09-14 23:31:57,941][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:31:59,277][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:32:04,177][flwr][INFO] - fit progress: (16, 207.5453940629959, {'accuracy': 0.2610347851505408}, 142.48828710708767)
[2024-09-14 23:32:04,177][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:32:04,746][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:32:04,746][flwr][INFO] - 
[2024-09-14 23:32:04,746][flwr][INFO] - [ROUND 17]
[2024-09-14 23:32:04,746][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:32:08,394][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:32:13,266][flwr][INFO] - fit progress: (17, 175.5144054889679, {'accuracy': 0.3706518561824028}, 151.57708803704008)
[2024-09-14 23:32:13,266][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:32:13,614][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:32:13,614][flwr][INFO] - 
[2024-09-14 23:32:13,614][flwr][INFO] - [ROUND 18]
[2024-09-14 23:32:13,614][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:32:17,298][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:32:22,248][flwr][INFO] - fit progress: (18, 182.98022842407227, {'accuracy': 0.3724057293189126}, 160.5587801290676)
[2024-09-14 23:32:22,248][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:32:22,530][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:32:22,530][flwr][INFO] - 
[2024-09-14 23:32:22,530][flwr][INFO] - [ROUND 19]
[2024-09-14 23:32:22,530][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:32:22,605][flwr][ERROR] - Traceback (most recent call last):
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

[2024-09-14 23:32:22,606][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
[2024-09-14 23:32:24,113][flwr][INFO] - aggregate_fit: received 4 results and 1 failures
[2024-09-14 23:32:29,117][flwr][INFO] - fit progress: (19, 211.35913944244385, {'accuracy': 0.29201987722888045}, 167.42851977981627)
[2024-09-14 23:32:29,118][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:32:29,546][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:32:29,546][flwr][INFO] - 
[2024-09-14 23:32:29,546][flwr][INFO] - [ROUND 20]
[2024-09-14 23:32:29,546][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:32:32,165][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:32:37,040][flwr][INFO] - fit progress: (20, 181.87163853645325, {'accuracy': 0.29611224788073665}, 175.3510471289046)
[2024-09-14 23:32:37,040][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:32:37,441][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:32:37,441][flwr][INFO] - 
[2024-09-14 23:32:37,441][flwr][INFO] - [ROUND 21]
[2024-09-14 23:32:37,441][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:32:41,612][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:32:46,482][flwr][INFO] - fit progress: (21, 158.96309578418732, {'accuracy': 0.4063139432914353}, 184.79327435372397)
[2024-09-14 23:32:46,483][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:32:46,838][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:32:46,838][flwr][INFO] - 
[2024-09-14 23:32:46,838][flwr][INFO] - [ROUND 22]
[2024-09-14 23:32:46,838][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:32:50,496][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:32:55,394][flwr][INFO] - fit progress: (22, 179.43631756305695, {'accuracy': 0.3086816720257235}, 193.7053313809447)
[2024-09-14 23:32:55,394][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:32:55,692][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:32:55,692][flwr][INFO] - 
[2024-09-14 23:32:55,692][flwr][INFO] - [ROUND 23]
[2024-09-14 23:32:55,693][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:32:59,936][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:33:05,514][flwr][INFO] - fit progress: (23, 184.3865625858307, {'accuracy': 0.33440514469453375}, 203.82472639298066)
[2024-09-14 23:33:05,514][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:33:05,838][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:33:05,839][flwr][INFO] - 
[2024-09-14 23:33:05,839][flwr][INFO] - [ROUND 24]
[2024-09-14 23:33:05,839][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:33:09,136][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:33:13,996][flwr][INFO] - fit progress: (24, 162.48863780498505, {'accuracy': 0.47734580532008186}, 212.3067309181206)
[2024-09-14 23:33:13,996][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:33:14,329][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:33:14,329][flwr][INFO] - 
[2024-09-14 23:33:14,329][flwr][INFO] - [ROUND 25]
[2024-09-14 23:33:14,330][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:33:17,108][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:33:21,996][flwr][INFO] - fit progress: (25, 162.48698341846466, {'accuracy': 0.34375913475591935}, 220.3067585946992)
[2024-09-14 23:33:21,996][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:33:22,342][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:33:22,342][flwr][INFO] - 
[2024-09-14 23:33:22,342][flwr][INFO] - [ROUND 26]
[2024-09-14 23:33:22,342][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:33:26,420][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:33:31,308][flwr][INFO] - fit progress: (26, 195.55982565879822, {'accuracy': 0.3051739257527039}, 229.61875253589824)
[2024-09-14 23:33:31,308][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:33:31,738][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:33:31,738][flwr][INFO] - 
[2024-09-14 23:33:31,738][flwr][INFO] - [ROUND 27]
[2024-09-14 23:33:31,738][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:33:35,447][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:33:40,652][flwr][INFO] - fit progress: (27, 166.0721014738083, {'accuracy': 0.413914060216311}, 238.9628752847202)
[2024-09-14 23:33:40,652][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:33:41,085][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:33:41,085][flwr][INFO] - 
[2024-09-14 23:33:41,085][flwr][INFO] - [ROUND 28]
[2024-09-14 23:33:41,085][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:33:43,967][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:33:48,814][flwr][INFO] - fit progress: (28, 156.5351746082306, {'accuracy': 0.40046769950306926}, 247.12491794396192)
[2024-09-14 23:33:48,814][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:33:49,126][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:33:49,126][flwr][INFO] - 
[2024-09-14 23:33:49,126][flwr][INFO] - [ROUND 29]
[2024-09-14 23:33:49,126][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:33:54,480][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:33:59,482][flwr][INFO] - fit progress: (29, 146.70464861392975, {'accuracy': 0.4586378251973107}, 257.7934467489831)
[2024-09-14 23:33:59,483][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:33:59,945][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:33:59,946][flwr][INFO] - 
[2024-09-14 23:33:59,946][flwr][INFO] - [ROUND 30]
[2024-09-14 23:33:59,946][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:34:04,945][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:34:09,771][flwr][INFO] - fit progress: (30, 141.6365077495575, {'accuracy': 0.6337328266588717}, 268.0823025079444)
[2024-09-14 23:34:09,771][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:34:10,074][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:34:10,074][flwr][INFO] - 
[2024-09-14 23:34:10,074][flwr][INFO] - [ROUND 31]
[2024-09-14 23:34:10,074][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:34:12,843][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:34:17,647][flwr][INFO] - fit progress: (31, 139.9282306432724, {'accuracy': 0.5325928091201403}, 275.9584295670502)
[2024-09-14 23:34:17,648][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:34:18,110][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:34:18,111][flwr][INFO] - 
[2024-09-14 23:34:18,111][flwr][INFO] - [ROUND 32]
[2024-09-14 23:34:18,111][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:34:20,702][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:34:25,688][flwr][INFO] - fit progress: (32, 179.19963669776917, {'accuracy': 0.3189125986553639}, 283.9994461867027)
[2024-09-14 23:34:25,689][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:34:26,051][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:34:26,051][flwr][INFO] - 
[2024-09-14 23:34:26,051][flwr][INFO] - [ROUND 33]
[2024-09-14 23:34:26,051][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:34:26,133][flwr][ERROR] - Traceback (most recent call last):
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

[2024-09-14 23:34:26,134][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
[2024-09-14 23:34:30,599][flwr][INFO] - aggregate_fit: received 4 results and 1 failures
[2024-09-14 23:34:35,387][flwr][INFO] - fit progress: (33, 157.61065590381622, {'accuracy': 0.4738380590470623}, 293.698452279903)
[2024-09-14 23:34:35,388][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:34:35,700][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:34:35,700][flwr][INFO] - 
[2024-09-14 23:34:35,700][flwr][INFO] - [ROUND 34]
[2024-09-14 23:34:35,700][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:34:38,397][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:34:43,489][flwr][INFO] - fit progress: (34, 208.8288460969925, {'accuracy': 0.33557439345220696}, 301.80016822880134)
[2024-09-14 23:34:43,489][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:34:43,888][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:34:43,889][flwr][INFO] - 
[2024-09-14 23:34:43,889][flwr][INFO] - [ROUND 35]
[2024-09-14 23:34:43,889][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:34:46,944][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:34:51,826][flwr][INFO] - fit progress: (35, 155.378660261631, {'accuracy': 0.49400760011692485}, 310.13757284078747)
[2024-09-14 23:34:51,827][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:34:52,275][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:34:52,275][flwr][INFO] - 
[2024-09-14 23:34:52,275][flwr][INFO] - [ROUND 36]
[2024-09-14 23:34:52,276][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:34:56,078][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:35:00,969][flwr][INFO] - fit progress: (36, 160.60456538200378, {'accuracy': 0.4156679333528208}, 319.27983617503196)
[2024-09-14 23:35:00,969][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:35:01,051][flwr][ERROR] - Traceback (most recent call last):
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

[2024-09-14 23:35:01,052][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
[2024-09-14 23:35:01,268][flwr][INFO] - aggregate_evaluate: received 1 results and 1 failures
[2024-09-14 23:35:01,268][flwr][INFO] - 
[2024-09-14 23:35:01,268][flwr][INFO] - [ROUND 37]
[2024-09-14 23:35:01,268][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:35:05,385][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:35:10,283][flwr][INFO] - fit progress: (37, 137.95312029123306, {'accuracy': 0.4419760304004677}, 328.5943981939927)
[2024-09-14 23:35:10,283][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:35:10,633][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:35:10,633][flwr][INFO] - 
[2024-09-14 23:35:10,633][flwr][INFO] - [ROUND 38]
[2024-09-14 23:35:10,633][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:35:11,316][flwr][ERROR] - Traceback (most recent call last):
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

[2024-09-14 23:35:11,317][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
[2024-09-14 23:35:11,916][flwr][INFO] - aggregate_fit: received 4 results and 1 failures
[2024-09-14 23:35:16,760][flwr][INFO] - fit progress: (38, 137.85068935155869, {'accuracy': 0.5504238526746565}, 335.0711243180558)
[2024-09-14 23:35:16,760][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:35:17,073][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:35:17,073][flwr][INFO] - 
[2024-09-14 23:35:17,073][flwr][INFO] - [ROUND 39]
[2024-09-14 23:35:17,074][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:35:21,110][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:35:26,019][flwr][INFO] - fit progress: (39, 115.19015848636627, {'accuracy': 0.6527331189710611}, 344.33033388480544)
[2024-09-14 23:35:26,020][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:35:26,366][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:35:26,367][flwr][INFO] - 
[2024-09-14 23:35:26,367][flwr][INFO] - [ROUND 40]
[2024-09-14 23:35:26,367][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:35:30,164][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:35:35,054][flwr][INFO] - fit progress: (40, 113.15437817573547, {'accuracy': 0.6568254896229173}, 353.365528549999)
[2024-09-14 23:35:35,055][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:35:35,362][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:35:35,362][flwr][INFO] - 
[2024-09-14 23:35:35,363][flwr][INFO] - [ROUND 41]
[2024-09-14 23:35:35,363][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:35:37,608][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:35:42,492][flwr][INFO] - fit progress: (41, 128.28866112232208, {'accuracy': 0.5805320081847413}, 360.8032430727035)
[2024-09-14 23:35:42,492][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:35:43,134][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:35:43,135][flwr][INFO] - 
[2024-09-14 23:35:43,135][flwr][INFO] - [ROUND 42]
[2024-09-14 23:35:43,135][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:35:43,234][flwr][ERROR] - Traceback (most recent call last):
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

[2024-09-14 23:35:43,234][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120946, ip=115.145.172.224, actor_id=cebcaa570c072cc81916cdb601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f8df428d630>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
[2024-09-14 23:35:44,633][flwr][INFO] - aggregate_fit: received 4 results and 1 failures
[2024-09-14 23:35:49,515][flwr][INFO] - fit progress: (42, 123.32599598169327, {'accuracy': 0.6074247296112247}, 367.82650515204296)
[2024-09-14 23:35:49,516][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:35:49,869][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:35:49,870][flwr][INFO] - 
[2024-09-14 23:35:49,870][flwr][INFO] - [ROUND 43]
[2024-09-14 23:35:49,870][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:35:55,010][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:36:00,237][flwr][INFO] - fit progress: (43, 119.96316879987717, {'accuracy': 0.668225665010231}, 378.5480095320381)
[2024-09-14 23:36:00,237][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:36:00,707][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:36:00,707][flwr][INFO] - 
[2024-09-14 23:36:00,707][flwr][INFO] - [ROUND 44]
[2024-09-14 23:36:00,708][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:36:04,819][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:36:09,681][flwr][INFO] - fit progress: (44, 119.87371683120728, {'accuracy': 0.556854720841859}, 387.99181038793176)
[2024-09-14 23:36:09,681][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:36:09,978][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:36:09,978][flwr][INFO] - 
[2024-09-14 23:36:09,978][flwr][INFO] - [ROUND 45]
[2024-09-14 23:36:09,979][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:36:15,045][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:36:19,921][flwr][INFO] - fit progress: (45, 100.71002089977264, {'accuracy': 0.6691026015784858}, 398.2320594410412)
[2024-09-14 23:36:19,921][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:36:20,443][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:36:20,444][flwr][INFO] - 
[2024-09-14 23:36:20,444][flwr][INFO] - [ROUND 46]
[2024-09-14 23:36:20,444][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:36:24,004][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:36:28,989][flwr][INFO] - fit progress: (46, 98.26326203346252, {'accuracy': 0.7296112247880736}, 407.29987502191216)
[2024-09-14 23:36:28,989][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:36:29,346][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:36:29,346][flwr][INFO] - 
[2024-09-14 23:36:29,346][flwr][INFO] - [ROUND 47]
[2024-09-14 23:36:29,347][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:36:33,445][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:36:38,257][flwr][INFO] - fit progress: (47, 102.95068538188934, {'accuracy': 0.6767027185033616}, 416.56859411485493)
[2024-09-14 23:36:38,258][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:36:38,869][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:36:38,870][flwr][INFO] - 
[2024-09-14 23:36:38,870][flwr][INFO] - [ROUND 48]
[2024-09-14 23:36:38,870][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:36:43,006][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:36:47,868][flwr][INFO] - fit progress: (48, 130.231664955616, {'accuracy': 0.5045308389359836}, 426.1792731927708)
[2024-09-14 23:36:47,869][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:36:48,260][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:36:48,260][flwr][INFO] - 
[2024-09-14 23:36:48,260][flwr][INFO] - [ROUND 49]
[2024-09-14 23:36:48,261][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:36:51,733][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:36:56,804][flwr][INFO] - fit progress: (49, 137.86095535755157, {'accuracy': 0.49313066354866997}, 435.1148370918818)
[2024-09-14 23:36:56,804][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:36:57,325][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:36:57,325][flwr][INFO] - 
[2024-09-14 23:36:57,325][flwr][INFO] - [ROUND 50]
[2024-09-14 23:36:57,325][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:37:02,544][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:37:07,445][flwr][INFO] - fit progress: (50, 93.54593050479889, {'accuracy': 0.7354574685764397}, 445.7567221177742)
[2024-09-14 23:37:07,446][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:37:07,754][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:37:07,754][flwr][INFO] - 
[2024-09-14 23:37:07,755][flwr][INFO] - [ROUND 51]
[2024-09-14 23:37:07,755][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:37:11,791][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:37:16,687][flwr][INFO] - fit progress: (51, 110.28294771909714, {'accuracy': 0.62028646594563}, 454.99789885105565)
[2024-09-14 23:37:16,687][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:37:17,115][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:37:17,115][flwr][INFO] - 
[2024-09-14 23:37:17,115][flwr][INFO] - [ROUND 52]
[2024-09-14 23:37:17,115][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:37:21,712][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:37:26,664][flwr][INFO] - fit progress: (52, 95.78369331359863, {'accuracy': 0.6977491961414791}, 464.97478472907096)
[2024-09-14 23:37:26,664][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:37:26,991][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:37:26,991][flwr][INFO] - 
[2024-09-14 23:37:26,991][flwr][INFO] - [ROUND 53]
[2024-09-14 23:37:26,991][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:37:29,357][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:37:34,239][flwr][INFO] - fit progress: (53, 110.13472026586533, {'accuracy': 0.6167787196726103}, 472.55035116290674)
[2024-09-14 23:37:34,239][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:37:34,324][flwr][ERROR] - Traceback (most recent call last):
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 94, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 398, in get_client_result
    return self._fetch_future_result(cid)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 279, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/abdenour/.local/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

[2024-09-14 23:37:34,324][flwr][ERROR] - [36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 143, in __call__
    return self._call(message, context)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/client_app.py", line 126, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 95, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/home/abdenour/fl_with_flower/fednova_mobilnet/fednova_mobilnet/client.py", line 115, in client_fn
    client_dataset_splits = client_dataset.train_test_split(test_size=0.1, seed=42)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 567, in wrapper
    out: Union["Dataset", "DatasetDict"] = func(self, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/fingerprint.py", line 482, in wrapper
    out = func(dataset, *args, **kwargs)
  File "/home/abdenour/.local/lib/python3.10/site-packages/datasets/arrow_dataset.py", line 4587, in train_test_split
    raise ValueError(
ValueError: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=4120947, ip=115.145.172.224, actor_id=c63ebec9dbbb62e71a9a5c5601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7f47c8271780>)
  File "/home/abdenour/.local/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 63, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: With n_samples=1, test_size=0.1 and train_size=None, the resulting train set will be empty. Adjust any of the aforementioned parameters.
[2024-09-14 23:37:34,553][flwr][INFO] - aggregate_evaluate: received 1 results and 1 failures
[2024-09-14 23:37:34,554][flwr][INFO] - 
[2024-09-14 23:37:34,554][flwr][INFO] - [ROUND 54]
[2024-09-14 23:37:34,554][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:37:37,301][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:37:42,148][flwr][INFO] - fit progress: (54, 109.23304581642151, {'accuracy': 0.6515638702133879}, 480.4588971519843)
[2024-09-14 23:37:42,148][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:37:42,450][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:37:42,450][flwr][INFO] - 
[2024-09-14 23:37:42,450][flwr][INFO] - [ROUND 55]
[2024-09-14 23:37:42,450][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:37:46,921][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
[2024-09-14 23:37:51,955][flwr][INFO] - fit progress: (55, 87.55336594581604, {'accuracy': 0.7281496638409821}, 490.26630224473774)
[2024-09-14 23:37:51,956][flwr][INFO] - configure_evaluate: strategy sampled 2 clients (out of 50)
[2024-09-14 23:37:52,352][flwr][INFO] - aggregate_evaluate: received 2 results and 0 failures
[2024-09-14 23:37:52,352][flwr][INFO] - 
[2024-09-14 23:37:52,352][flwr][INFO] - [ROUND 56]
[2024-09-14 23:37:52,353][flwr][INFO] - configure_fit: strategy sampled 5 clients (out of 50)
[2024-09-14 23:37:55,663][flwr][INFO] - aggregate_fit: received 5 results and 0 failures
